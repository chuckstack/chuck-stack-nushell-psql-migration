# Test-specific psqlrc configuration
# This file is used when PSQLRC environment variable points to it

# Error handling - critical for migration testing
\set ON_ERROR_STOP on
\set ON_ERROR_ROLLBACK on

# Output formatting for better test readability
\pset border 1
\pset format aligned
\pset null '<NULL>'
\pset pager off

# Timing for performance testing
\timing on

# Show context for errors
\set VERBOSITY verbose

# Helpful aliases for testing
\set migration_status 'SELECT track_name, COUNT(*) as applied_count FROM (SELECT SPLIT_PART(tablename, \'_\', 2) as track_name FROM pg_tables WHERE tablename LIKE \'migrations_%\') tracks GROUP BY track_name;'

# Echo commands for debugging
\set ECHO queries

# Custom prompt to show we're in test mode
\set PROMPT1 '[TEST] %n@%M:%> %/%R%# '
\set PROMPT2 '[TEST] %n@%M:%> %/%R%# '

# Welcome message
\echo 'Connected to migration test database'
\echo 'Use \\set to see available variables'
\echo 'Use :migration_status to see current migration state'